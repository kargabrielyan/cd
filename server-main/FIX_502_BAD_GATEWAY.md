# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ 502 Bad Gateway

**–ü—Ä–æ–±–ª–µ–º–∞:** Nginx –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 502 Bad Gateway –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ `http://centraldispatch.id`

**–ü—Ä–∏—á–∏–Ω–∞:** Nginx –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Node.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –Ω–∞ –ø–æ—Ä—Ç—É 3000.

---

## üö® –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (–≤—ã–ø–æ–ª–Ω–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Node.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ
pm2 status

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–ª—É—à–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3000
netstat -tlnp | grep 3000
# –∏–ª–∏
ss -tlnp | grep 3000

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ PM2
pm2 logs centraldispatch-nextjs --lines 50
# –∏–ª–∏ –µ—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ-–¥—Ä—É–≥–æ–º—É:
pm2 logs --lines 50

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–≤–µ—á–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
curl http://localhost:3000

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Nginx
tail -30 /var/log/nginx/error.log
tail -30 /var/log/nginx/centraldispatch.id.error.log 2>/dev/null
```

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ 1: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω–æ –∏–ª–∏ —É–ø–∞–ª–æ

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
pm2 status

# 2. –ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω–æ –∏–ª–∏ —É–ø–∞–ª–æ, –∑–∞–ø—É—Å—Ç–∏—Ç—å:
cd /var/www/centraldispatch.id
source ~/.nvm/nvm.sh

# 3. –î–ª—è Next.js:
pm2 start npm --name "centraldispatch-nextjs" -- start

# 4. –ò–ª–∏ –¥–ª—è Express:
pm2 start app.js --name "centraldispatch-server"

# 5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
pm2 save

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
pm2 logs --lines 50
```

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ 2: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —Å–ª—É—à–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3000

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –∫–∞–∫–æ–º –ø–æ—Ä—Ç—É —Å–ª—É—à–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
netstat -tlnp | grep node
# –∏–ª–∏
ss -tlnp | grep node

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env —Ñ–∞–π–ª
cat .env | grep PORT

# 3. –ï—Å–ª–∏ –ø–æ—Ä—Ç –¥—Ä—É–≥–æ–π, –ª–∏–±–æ:
# - –ò–∑–º–µ–Ω–∏—Ç—å PORT –≤ .env
# - –ò–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–ª—É—à–∞–µ—Ç –Ω–∞ 0.0.0.0 –∏–ª–∏ localhost
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: 0.0.0.0:3000 –∏–ª–∏ 127.0.0.1:3000
```

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ 3: –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ Next.js

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–±—Ä–∞–Ω–æ
ls -la .next/

# 2. –ï—Å–ª–∏ –ø–∞–ø–∫–∏ .next/ –Ω–µ—Ç, —Å–æ–±—Ä–∞—Ç—å:
npm run build

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—à–∏–±–∫–∏ —Å–±–æ—Ä–∫–∏
npm run build 2>&1 | tee build.log

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
pm2 restart centraldispatch-nextjs
# –∏–ª–∏
pm2 delete centraldispatch-nextjs
pm2 start npm --name "centraldispatch-nextjs" -- start
```

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx
nginx -t

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Nginx –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç
grep -r "proxy_pass.*3000" /etc/nginx/sites-enabled/

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è –¥–æ–º–µ–Ω–∞
cat /etc/nginx/sites-enabled/centraldispatch.id*

# 4. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# proxy_pass http://localhost:3000;
# –∏–ª–∏
# proxy_pass http://127.0.0.1:3000;

# 5. –ï—Å–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –∏—Å–ø—Ä–∞–≤–∏—Ç—å:
nano /etc/nginx/sites-available/centraldispatch.id
# –ò–∑–º–µ–Ω–∏—Ç—å proxy_pass –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç

# 6. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å Nginx
nginx -t && systemctl reload nginx
```

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∏ SELinux

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç —Å–ª—É—à–∞—Ç—å –Ω–∞ –ø–æ—Ä—Ç—É
# (–æ–±—ã—á–Ω–æ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞, –Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–æ–∏—Ç)

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å firewall (–Ω–µ –¥–æ–ª–∂–µ–Ω –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å localhost)
firewall-cmd --list-all 2>/dev/null || ufw status

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–æ—Ä—Ç 3000 –Ω–µ –∑–∞–Ω—è—Ç –¥—Ä—É–≥–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º
lsof -i :3000
# –∏–ª–∏
netstat -tlnp | grep 3000

# 4. –ï—Å–ª–∏ –ø–æ—Ä—Ç –∑–∞–Ω—è—Ç –¥—Ä—É–≥–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º, –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ–≥–æ:
# pm2 stop all
# –∏–ª–∏ –Ω–∞–π—Ç–∏ –∏ —É–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å:
# kill -9 $(lsof -t -i:3000)
```

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ 6: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ PM2 –ø—Ä–æ—Ü–µ—Å—Å—ã
pm2 stop all

# 2. –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
pm2 delete all

# 3. –ü–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /var/www/centraldispatch.id
source ~/.nvm/nvm.sh

# 4. –î–ª—è Next.js:
npm run build
pm2 start npm --name "centraldispatch-nextjs" -- start

# 5. –î–ª—è Express:
pm2 start app.js --name "centraldispatch-server"

# 6. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
pm2 save

# 7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
curl http://localhost:3000

# 8. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å Nginx
systemctl reload nginx

# 9. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ –¥–æ–º–µ–Ω
curl http://centraldispatch.id
```

---

## üîç –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã

```bash
# –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã Node.js
ps aux | grep node

# –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã PM2
pm2 list

# –ü—Ä–æ—Ü–µ—Å—Å—ã –Ω–∞ –ø–æ—Ä—Ç—É 3000
lsof -i :3000
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏

```bash
# –õ–æ–≥–∏ PM2
pm2 logs --lines 100 --nostream

# –õ–æ–≥–∏ Nginx
tail -50 /var/log/nginx/error.log
tail -50 /var/log/nginx/centraldispatch.id.error.log 2>/dev/null

# –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏
journalctl -u nginx -n 50
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```bash
# –ß—Ç–æ —Å–ª—É—à–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3000
netstat -tlnp | grep 3000
ss -tlnp | grep 3000

# –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–∞
curl -v http://localhost:3000
telnet localhost 3000
```

---

## üêõ –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

### –û—à–∏–±–∫–∞: "Cannot find module"

```bash
# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
rm -rf node_modules package-lock.json
npm install
```

### –û—à–∏–±–∫–∞: "Port 3000 is already in use"

```bash
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ—Ä—Ç—É 3000
lsof -i :3000
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –µ–≥–æ
kill -9 $(lsof -t -i:3000)
# –ò–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç –≤ .env
```

### –û—à–∏–±–∫–∞: "EADDRINUSE"

```bash
# –ü–æ—Ä—Ç –∑–∞–Ω—è—Ç, –Ω–∞–π—Ç–∏ –∏ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å:
netstat -tlnp | grep 3000
kill -9 <PID>
```

### –û—à–∏–±–∫–∞: Next.js –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è

```bash
# –û—á–∏—Å—Ç–∏—Ç—å –∏ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
rm -rf .next
npm run build
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ PM2 –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—â–µ–Ω (`pm2 status`)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–ª—É—à–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3000 (`netstat -tlnp | grep 3000`)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–≤–µ—á–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ (`curl http://localhost:3000`)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª –ª–æ–≥–∏ PM2 –Ω–∞ –æ—à–∏–±–∫–∏ (`pm2 logs`)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª –ª–æ–≥–∏ Nginx –Ω–∞ –æ—à–∏–±–∫–∏ (`tail /var/log/nginx/error.log`)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Nginx (`nginx -t`)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ Nginx –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç
- [ ] –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ PM2
- [ ] –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–ª Nginx (`systemctl reload nginx`)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —Ä–∞–±–æ—Ç—É —á–µ—Ä–µ–∑ –¥–æ–º–µ–Ω (`curl http://centraldispatch.id`)

---

## üìù –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π)

–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–ª–æ, –≤—ã–ø–æ–ª–Ω–∏ –ø–æ–ª–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫:

```bash
cd /var/www/centraldispatch.id && \
source ~/.nvm/nvm.sh && \
pm2 stop all && \
pm2 delete all && \
npm run build && \
pm2 start npm --name "centraldispatch-nextjs" -- start && \
pm2 save && \
systemctl reload nginx && \
sleep 2 && \
curl http://localhost:3000 && \
echo "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"
```

---

**–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö —à–∞–≥–æ–≤ –æ—à–∏–±–∫–∞ 502 –¥–æ–ª–∂–Ω–∞ –∏—Å—á–µ–∑–Ω—É—Ç—å!** üéâ

