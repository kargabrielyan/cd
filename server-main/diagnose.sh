#!/bin/bash

echo "=========================================="
echo "üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Nginx –∏ Node.js"
echo "=========================================="
echo ""

echo "1Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π Nginx:"
echo "----------------------------------------"
ls -la /etc/nginx/sites-enabled/
echo ""

echo "2Ô∏è‚É£ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ centraldispatch.id:"
echo "----------------------------------------"
cat /etc/nginx/sites-available/centraldispatch.id 2>/dev/null || echo "–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω!"
echo ""

echo "3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã Nginx:"
echo "----------------------------------------"
curl -s http://localhost | head -5
echo ""

echo "4Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx:"
echo "----------------------------------------"
nginx -t
echo ""

echo "5Ô∏è‚É£ –°—Ç–∞—Ç—É—Å PM2:"
echo "----------------------------------------"
pm2 status
echo ""

echo "6Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ Node.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:"
echo "----------------------------------------"
curl -s http://localhost:3000 | head -3
echo ""
echo ""

echo "7Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Nginx (localhost):"
echo "----------------------------------------"
curl -s http://localhost | head -10
echo ""

echo "8Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Nginx —Å Host header:"
echo "----------------------------------------"
curl -s -H "Host: centraldispatch.id" http://localhost | head -10
echo ""

echo "9Ô∏è‚É£ –ü–æ—Ä—Ç—ã –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏:"
echo "----------------------------------------"
netstat -tlnp | grep -E ':(80|3000)' || ss -tlnp | grep -E ':(80|3000)'
echo ""

echo "üîü –õ–æ–≥–∏ Nginx (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å—Ç—Ä–æ–∫):"
echo "----------------------------------------"
tail -5 /var/log/nginx/access.log 2>/dev/null || echo "–õ–æ–≥ –Ω–µ –Ω–∞–π–¥–µ–Ω"
echo ""

echo "‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
echo "=========================================="

