# План разработки: CentralDispatch - Минимальный вариант

## Общее описание проекта

Минимальное веб-приложение с точным воспроизведением формы входа CentralDispatch:
1. Страница входа (Sign In) - точная копия дизайна
2. Отправка Email с логином и паролем после входа
3. Страница ввода 6-значного кода
4. Отправка кода администратору
5. Показ 404 страницы после подтверждения кода

## Функциональность

**Поток работы:**
1. Пользователь вводит Username и Password на странице Sign In
2. После нажатия "SIGN IN":
   - Логин и пароль отправляются администратору по Email
   - Пользователь перенаправляется на страницу ввода 6-значного кода
3. Пользователь вводит 6-значный код
4. Код отправляется администратору по Email
5. После подтверждения кода пользователь видит страницу 404 Error

---

## Технический стек (Минимальный вариант)

### Frontend:
- **Framework:** Next.js 14+ с App Router
- **Язык:** TypeScript
- **Стилизация:** Tailwind CSS
- **Маршрутизация:** Next.js App Router

### Backend (встроен в Next.js):
- **API Routes:** Next.js API Routes
- **Сессии:** Cookies для отслеживания шагов
- **Валидация:** Встроенная валидация форм

### Уведомления:
- **Email:** Nodemailer с SMTP (Gmail или другой провайдер)

### Инструменты разработки:
- **Линтинг:** ESLint + Prettier

---

## Детальное описание страницы входа (Sign In)

### Структура формы (сверху вниз):

1. **Карточка контейнера**
   - Центрированная вертикальная карточка
   - Белый фон, закругленные углы, тонкая серая рамка
   - Внутренние отступы (padding)

2. **Логотип**
   - Слева: оранжевый круглый знак (иконка)
   - Справа: текст "CentralDispatch" (большой)
   - Под ним: "by Cox Automotive" (маленький)
   - Центрирование по горизонтали

3. **Разделительная линия**
   - Тонкая горизонтальная серая линия

4. **Заголовок "SIGN IN"**
   - Заглавными буквами, темно-синий цвет
   - Центрирован, крупный шрифт

5. **Информационный блок (Reminder)**
   - Светло-голубой фон
   - Синий заголовок с иконкой info слева
   - Полный текст:
     ```
     Remember:
     Never click on any links received via email and/or text from anyone, including other customers, directing you to Central Dispatch. Always type the URL into your browser before entering login / account information. For more tips on how to stay safe at every step of your shipping process, type in this URL: CentralDispatch.com/Secure.
     ```
   - URL `CentralDispatch.com/Secure` кликабельный

6. **Поле Username**
   - Label: "Username" (маленький серый текст)
   - Input: текстовое поле, белый фон, серая рамка

7. **Поле Password**
   - Label: "Password"
   - Input: тип password, иконка глаза справа для показа/скрытия

8. **Чекбокс "Remember my Username"**
   - Чекбокс слева от текста
   - Сохранение в localStorage при включении

9. **Кнопка "SIGN IN"**
   - Большая желтая кнопка
   - Темный текст (черный/темно-серый)
   - Закругленные углы
   - Центрирована

10. **Блок "Forgot?"**
    - Слева: "Forgot?" (маленький текст)
    - Справа: ссылки "USERNAME" и "PASSWORD" (заглавными)

11. **Секция регистрации**
    - Текст: "Not A Member?" (центрирован, маленький)
    - Кнопка: "CREATE AN ACCOUNT" (синяя обводка, белый фон)

---

## Этапы разработки

### Этап 1: Настройка проекта и окружения
**Задачи:**
- Инициализация Next.js проекта с TypeScript
- Установка и настройка Tailwind CSS
- Настройка структуры папок
- Настройка ESLint и Prettier
- Создание .env.local для переменных окружения

**Выходные артефакты:**
- Рабочее окружение разработки
- Базовая структура проекта

---

### Этап 2: Разработка страницы входа (Sign In)
**Задачи:**
- Создание компонента Logo (оранжевая иконка + текст)
- Реализация всех элементов формы согласно детальному описанию:
  - Заголовок SIGN IN
  - Информационный блок с полным текстом
  - Поля Username и Password
  - Иконка показа/скрытия пароля
  - Чекбокс "Remember my Username"
  - Кнопка SIGN IN
  - Блок "Forgot?"
  - Секция регистрации
- Точная стилизация согласно дизайну:
  - Желтая кнопка SIGN IN
  - Светло-голубой информационный блок
  - Серые рамки, белый фон карточки
- Адаптивность (desktop, tablet, mobile)
- Валидация полей
- Визуальное логирование (console.log)

**Выходные артефакты:**
- Полностью реализованная страница входа
- Все элементы согласно описанию
- Адаптивная верстка

---

### Этап 3: Backend - API входа и отправки Email
**Задачи:**
- Создание API endpoint `/api/auth/login`
- Прием Username и Password
- Отправка Email администратору с логином и паролем:
  - Настройка Nodemailer
  - Шаблон письма с данными входа
- Установка cookie сессии для отслеживания шага
- Редирект на страницу ввода кода после успешной отправки
- Обработка ошибок

**Выходные артефакты:**
- API endpoint для входа
- Рабочая отправка Email
- Управление сессией

---

### Этап 4: Страница ввода 6-значного кода
**Задачи:**
- Создание страницы `/verify-code`
- Форма для ввода 6-значного кода:
  - 6 отдельных input полей (по одному символу)
  - Или одно поле с маской для 6 цифр
  - Валидация (только цифры, 6 символов)
- Дизайн аналогичный форме входа:
  - Та же цветовая схема
  - Та же типографика
  - Логотип вверху
- Защита маршрута (только после входа)

**Выходные артефакты:**
- Страница ввода кода
- Валидация ввода
- Защита маршрута

---

### Этап 5: API отправки кода
**Задачи:**
- Создание API endpoint `/api/verify-code`
- Прием 6-значного кода
- Отправка Email администратору с кодом
- Проверка сессии (пользователь должен быть на шаге ввода кода)
- После успешной отправки:
  - Обновление сессии
  - Редирект на страницу 404

**Выходные артефакты:**
- API endpoint для отправки кода
- Рабочая отправка Email с кодом
- Логика редиректа

---

### Этап 6: Страница 404 Error
**Задачи:**
- Создание кастомной страницы 404
- Дизайн в стиле приложения:
  - Логотип вверху
  - Заголовок "404" или "Page Not Found"
  - Текст ошибки
  - Та же цветовая схема

**Выходные артефакты:**
- Страница 404
- Стилизация в едином стиле

---

### Этап 7: Middleware и защита маршрутов
**Задачи:**
- Создание middleware.ts для Next.js
- Защита страницы `/verify-code` (только после входа)
- Защита страницы 404 (только после подтверждения кода)
- Редиректы неавторизованных пользователей

**Выходные артефакты:**
- Middleware для проверки сессий
- Защищенные маршруты
- Правильные редиректы

---

### Этап 8: Стилизация и доработка
**Задачи:**
- Точная настройка цветов (желтая кнопка, голубой блок)
- Настройка типографики
- Проверка всех интерактивных элементов
- Hover эффекты
- Анимации (опционально)
- Проверка контрастности цветов (WCAG)

**Выходные артефакты:**
- Полностью стилизованное приложение
- Все элементы работают корректно

---

### Этап 9: Тестирование
**Задачи:**
- Тестирование потока: вход → код → 404
- Тестирование отправки Email
- Тестирование валидации форм
- Тестирование адаптивности
- Исправление найденных ошибок

**Выходные артефакты:**
- Протестированное приложение
- Исправленные баги

---

### Этап 10: Документация
**Задачи:**
- README.md с инструкциями:
  - Установка и запуск
  - Настройка Email (SMTP)
  - Переменные окружения
- JSDoc комментарии к функциям

**Выходные артефакты:**
- README.md
- Задокументированный код

---

## Структура папок

```
CentralDispatch/
├── app/
│   ├── sign-in/
│   │   └── page.tsx              # Страница входа
│   ├── verify-code/
│   │   └── page.tsx              # Страница ввода 6-значного кода
│   ├── 404/
│   │   └── page.tsx              # Страница 404 (или not-found.tsx)
│   ├── api/
│   │   ├── auth/
│   │   │   └── login/
│   │   │       └── route.ts      # API: вход и отправка Email
│   │   └── verify-code/
│   │       └── route.ts          # API: отправка кода
│   ├── layout.tsx                # Главный layout
│   └── page.tsx                  # Главная (редирект на sign-in)
├── components/
│   ├── Logo/
│   │   └── Logo.tsx
│   ├── SignInForm/
│   │   └── SignInForm.tsx
│   └── CodeInput/
│       └── CodeInput.tsx
├── lib/
│   ├── email.ts                  # Отправка Email
│   └── session.ts                # Управление сессиями
├── middleware.ts                 # Защита маршрутов
├── types/
│   └── index.ts
├── public/
│   └── logo-central-dispatch.webp
├── .env.local
├── .env.example
├── package.json
├── tsconfig.json
├── tailwind.config.ts
├── next.config.js
├── PLAN.md
├── PROGRESS.md
└── README.md
```

---

## Переменные окружения (.env.local)

```env
# Email настройки
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USER=your-email@gmail.com
EMAIL_PASS=your-app-password
EMAIL_TO=admin@example.com

# Секрет для сессий (любая случайная строка)
SESSION_SECRET=your-random-secret-key
```

---

## Цветовая схема

- **Желтая кнопка SIGN IN:** #FFC107 или #FFB300 (желтый)
- **Текст на кнопке:** #000000 или #212121 (темный)
- **Голубой блок (Reminder):** #E3F2FD или #BBDEFB (светло-голубой)
- **Синий заголовок Reminder:** #1976D2 или #2196F3
- **Оранжевый логотип:** #FF6B35 или #FF5722
- **Серые рамки:** #E0E0E0 или #BDBDBD
- **Фон:** #FFFFFF (белый)
- **Текст:** #212121 или #424242 (темно-серый)

---

## Ключевые требования

1. **Точное воспроизведение дизайна формы входа** - все элементы как в описании
2. **Отправка Email после входа** - логин и пароль в письме
3. **Страница ввода 6-значного кода** - тот же дизайн
4. **Отправка кода по Email** - код в письме администратору
5. **404 страница после подтверждения** - кастомная страница ошибки
6. **Минимализм** - только необходимый функционал, без лишнего

---

## Возможные риски

1. **Настройка SMTP Email** - может требовать специальных настроек провайдера
   - Решение: Использовать Gmail с App Password или сервис типа SendGrid

2. **Точная стилизация** - подбор точных цветов и отступов
   - Решение: Использовать инструменты для извлечения цветов, тщательная работа с Tailwind

3. **Логотип** - сложная оранжевая иконка
   - Решение: Использовать существующий `logo-central-dispatch.webp` или создать SVG
